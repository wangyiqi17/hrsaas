<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
<script>

    // 导入
    // 返回的数据
    // const results = [
    //     {
    //         入职日期: 43535,
    //         姓名: "高大山",
    //         工号: 20089,
    //         手机号: 13041131879,
    //         转正日期: 43719
    //     },
    //     {
    //         入职日期: 43535,
    //         姓名: "高小山",
    //         工号: 20089,
    //         手机号: 13041131879,
    //         转正日期: 43719
    //     }
    // ]
    // const header = ['手机号','姓名', '入职日期', '转正日期', '工号']
    // // 路径映射表
    // const mapKeyPath = {
    //         入职日期: 'timeOfEntry',
    //         姓名: "name",
    //         工号: "workNumber",
    //         手机号: "mobile",
    //         转正日期: "correctionTime"
    //     }
    // const newArr = results.map(item => {
    //     const obj ={}
    //     for(let key in mapKeyPath) {
    //         obj[mapKeyPath[key]] = item[key]
    //     }
    //     return obj
    // })
    // console.log(newArr);



    // 导出
   const arr = [
        {
            correctionTime: "2018-11-30",
            departmentName: "总裁办",
            formOfEmployment: 1,
            id: "604f764971f93f3ac8f365c2",
            mobile: "13800000002",
            password: "e10adc3949ba59abbe56e057f20f883e",
            staffPhoto: "http://q6cu3t6jv.bkt.clouddn.com/1063705989926227968?t=1616204161907",
            timeOfEntry: "2018-11-02",
            username: "管理员",
            workNumber: "9002",
        },
        {
            correctionTime: "2018-11-30",
            departmentName: "总裁办",
            formOfEmployment: 1,
            id: "604f764971f93f3ac8f365c2",
            mobile: "13800000002",
            password: "e10adc3949ba59abbe56e057f20f883e",
            staffPhoto: "http://q6cu3t6jv.bkt.clouddn.com/1063705989926227968?t=1616204161907",
            timeOfEntry: "2018-11-02",
            username: "管理员",
            workNumber: "9002",
        }
    ]

    const exportExcelMapPath = {
        '手机号': 'mobile',
        '姓名': 'username',
        '入职日期': 'timeOfEntry',
        '聘用形式': 'formOfEmployment',
        '转正日期': 'correctionTime',
        '工号': 'workNumber',
        '部门': 'departmentName'
    }
    
    // 表头数据['手机号'，'姓名']
    const header = Object.keys(exportExcelMapPath)
    console.log(header);
    // 通过exportExcelMapPath里的key拿到mobile，通过arr里的mobile拿到数据
    const data = arr.map(item => {
        return header.map(h => item[exportExcelMapPath[h]])
    })
    console.log(data);
</script>
</body>
</html>